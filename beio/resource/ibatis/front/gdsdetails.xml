<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="gdsdetails">
	
	<select id="queryDetailsByCategoryIndex" parameterType="IndexHotGoodsVO" resultType="GoodsDetailVO">
		SELECT 
		    goods.*
		FROM
		    gds_details goods
		<choose>
			<when test='level == "2"'>
				WHERE goods.categoryID = #{id}
			</when>
			<when test='level == "1"'>
				INNER JOIN gds_category category ON goods.categoryID = category.id AND category.pid = #{id}
			</when>
			<otherwise>
				WHERE 1 = 0
			</otherwise>
		</choose>
		LIMIT 10
	</select>
	
	<select id="queryGoods" parameterType="GdsDetails" resultType="GoodsDetailVO">
		SELECT 
		    goods.*
		FROM
		    gds_details goods
		WHERE 1=1
		<if test="name != null and name != ''">
			AND goods.name REGEXP #{name}
		</if>
		ORDER BY goods.hot;
	</select>
	
</mapper>